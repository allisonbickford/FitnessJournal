<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>PlateStack.kt</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">app</a> &gt; <a href="index.source.html" class="el_package">com.catscoffeeandkitchen.fitnessjournal.ui.workouts.details.plates</a> &gt; <span class="el_source">PlateStack.kt</span></div><h1>PlateStack.kt</h1><pre class="source lang-java linenums">package com.catscoffeeandkitchen.fitnessjournal.ui.workouts.details.plates

import androidx.compose.foundation.background
import androidx.compose.foundation.layout.*
import androidx.compose.foundation.shape.RoundedCornerShape
import androidx.compose.material3.MaterialTheme
import androidx.compose.material3.Text
import androidx.compose.runtime.Composable
import androidx.compose.ui.Alignment
import androidx.compose.ui.Modifier
import androidx.compose.ui.draw.clip
import androidx.compose.ui.graphics.Brush
import androidx.compose.ui.graphics.Color
import androidx.compose.ui.graphics.toArgb
import androidx.compose.ui.text.style.TextOverflow
import androidx.compose.ui.tooling.preview.Preview
import androidx.compose.ui.unit.dp
import androidx.compose.ui.unit.sp
import androidx.core.graphics.ColorUtils

@Composable
fun PlateStack(
    plates: Map&lt;Double, Int&gt;
<span class="nc" id="L24">) {</span>
<span class="nc" id="L25">    Column(</span>
<span class="nc" id="L26">        horizontalAlignment = Alignment.CenterHorizontally,</span>
<span class="nc" id="L27">        modifier = Modifier.padding(12.dp)</span>
    ) {
<span class="nc bnc" id="L29" title="All 4 branches missed.">        plates</span>
<span class="nc bnc" id="L30" title="All 4 branches missed.">            .filter { it.value &gt; 0 }</span>
<span class="nc" id="L31">            .entries</span>
<span class="nc" id="L32">            .sortedBy { it.key }</span>
<span class="nc" id="L33">            .forEach { entry -&gt;</span>
<span class="nc bnc" id="L34" title="All 2 branches missed.">                for (i in 0 until entry.value) {</span>
<span class="nc" id="L35">                    PlateGraphic(weight = entry.key)</span>
                }
<span class="nc" id="L37">            }</span>
<span class="nc" id="L38">    }</span>
<span class="nc" id="L39">}</span>

@Composable
fun PlateStackVertical(
    plates: Map&lt;Double, Int&gt;
<span class="fc" id="L44">) {</span>
<span class="fc" id="L45">    Row(</span>
<span class="fc" id="L46">        verticalAlignment = Alignment.CenterVertically,</span>
<span class="fc" id="L47">        modifier = Modifier.padding(12.dp)</span>
    ) {
<span class="pc bpc" id="L49" title="3 of 4 branches missed.">        Box(</span>
<span class="fc" id="L50">            modifier = Modifier</span>
<span class="fc" id="L51">                .width(50.dp)</span>
<span class="fc" id="L52">                .height(12.dp)</span>
<span class="fc" id="L53">                .background(</span>
<span class="fc" id="L54">                    brush = Brush.verticalGradient(</span>
<span class="fc" id="L55">                        colors = listOf(</span>
<span class="fc" id="L56">                            Color.LightGray,</span>
<span class="fc" id="L57">                            Color.DarkGray</span>
                        )
                    )
                )
<span class="pc bpc" id="L61" title="3 of 4 branches missed.">        ) { }</span>

<span class="fc" id="L63">        Box(</span>
<span class="fc" id="L64">            modifier = Modifier</span>
<span class="fc" id="L65">                .width(10.dp)</span>
<span class="fc" id="L66">                .height(17.dp)</span>
<span class="fc" id="L67">                .background(</span>
<span class="fc" id="L68">                    brush = Brush.verticalGradient(</span>
<span class="fc" id="L69">                        colors = listOf(</span>
<span class="fc" id="L70">                            Color.LightGray,</span>
<span class="fc" id="L71">                            Color.DarkGray</span>
                        )
                    )
                )
<span class="pc bpc" id="L75" title="3 of 4 branches missed.">        ) { }</span>

<span class="fc" id="L77">        plates</span>
<span class="pc bpc" id="L78" title="2 of 4 branches missed.">            .filter { it.value &gt; 0 }</span>
<span class="fc" id="L79">            .entries</span>
<span class="fc" id="L80">            .sortedByDescending { it.key }</span>
<span class="fc" id="L81">            .forEach { entry -&gt;</span>
<span class="nc bnc" id="L82" title="All 2 branches missed.">                for (i in 0 until entry.value) {</span>
<span class="nc" id="L83">                    PlateGraphicVertical(weight = entry.key)</span>
                }
<span class="nc" id="L85">            }</span>

<span class="fc" id="L87">        Box(</span>
<span class="fc" id="L88">            modifier = Modifier</span>
<span class="fc" id="L89">                .width(15.dp)</span>
<span class="fc" id="L90">                .height(14.dp)</span>
<span class="fc" id="L91">                .background(</span>
<span class="fc" id="L92">                    brush = Brush.verticalGradient(</span>
<span class="fc" id="L93">                        colors = listOf(</span>
<span class="fc" id="L94">                            Color.LightGray,</span>
<span class="fc" id="L95">                            Color.DarkGray</span>
                        )
                    )
                )
<span class="pc bpc" id="L99" title="3 of 4 branches missed.">        ) { }</span>
<span class="pc" id="L100">    }</span>
<span class="fc" id="L101">}</span>

@Composable
fun PlateGraphic(
    weight: Double,
<span class="nc bnc" id="L106" title="All 8 branches missed.">) {</span>
<span class="nc" id="L107">    val weightColor = when (weight) {</span>
<span class="nc bnc" id="L108" title="All 4 branches missed.">        45.0 -&gt; Color.Red</span>
<span class="nc bnc" id="L109" title="All 4 branches missed.">        35.0 -&gt; Color.Yellow</span>
<span class="nc bnc" id="L110" title="All 4 branches missed.">        25.0 -&gt; Color.Green</span>
<span class="nc bnc" id="L111" title="All 4 branches missed.">        15.0 -&gt; Color.White</span>
<span class="nc bnc" id="L112" title="All 4 branches missed.">        10.0 -&gt; Color.Black</span>
<span class="nc bnc" id="L113" title="All 4 branches missed.">        5.0 -&gt; Color.Black</span>
<span class="nc bnc" id="L114" title="All 4 branches missed.">        2.5 -&gt; Color.Black</span>
<span class="nc" id="L115">        else -&gt; Color.Black</span>
    }

<span class="nc" id="L118">    val width = when (weight) {</span>
<span class="nc bnc" id="L119" title="All 4 branches missed.">        45.0 -&gt; 120.dp</span>
<span class="nc bnc" id="L120" title="All 4 branches missed.">        35.0 -&gt; 110.dp</span>
<span class="nc bnc" id="L121" title="All 4 branches missed.">        25.0 -&gt; 90.dp</span>
<span class="nc bnc" id="L122" title="All 4 branches missed.">        10.0 -&gt; 70.dp</span>
<span class="nc bnc" id="L123" title="All 4 branches missed.">        5.0 -&gt; 50.dp</span>
<span class="nc bnc" id="L124" title="All 4 branches missed.">        2.5 -&gt; 40.dp</span>
<span class="nc" id="L125">        else -&gt; 40.dp</span>
    }

<span class="nc" id="L128">    val contrast = ColorUtils.calculateContrast(</span>
<span class="nc" id="L129">        MaterialTheme.colorScheme.onSurface.toArgb(),</span>
<span class="nc" id="L130">        weightColor.toArgb())</span>

<span class="nc" id="L132">    Box(</span>
<span class="nc" id="L133">        modifier = Modifier</span>
<span class="nc" id="L134">            .clip(RoundedCornerShape(4.dp))</span>
<span class="nc" id="L135">            .height(20.dp)</span>
<span class="nc" id="L136">            .width(width)</span>
<span class="nc" id="L137">            .background(</span>
<span class="nc" id="L138">                brush = Brush.verticalGradient(</span>
<span class="nc" id="L139">                    colors = listOf(</span>
<span class="nc" id="L140">                        weightColor.copy(alpha = .8f),</span>
<span class="nc" id="L141">                        weightColor.copy(alpha = .6f)</span>
                    )
                )
            ),
    ) {
<span class="nc bnc" id="L146" title="All 4 branches missed.">        Text(</span>
<span class="nc" id="L147">            weight.toString().replace(&quot;.0&quot;, &quot;&quot;),</span>
<span class="nc bnc" id="L148" title="All 2 branches missed.">            color = if (contrast &gt; 1.5f) Color.White else Color.Black,</span>
<span class="nc" id="L149">            modifier = Modifier.align(Alignment.BottomCenter))</span>
<span class="nc" id="L150">    }</span>
<span class="nc bnc" id="L151" title="All 2 branches missed.">}</span>


@Composable
fun PlateGraphicVertical(
    weight: Double,
<span class="nc bnc" id="L157" title="All 8 branches missed.">) {</span>
<span class="nc" id="L158">    val weightColor = when (weight) {</span>
<span class="nc bnc" id="L159" title="All 4 branches missed.">        45.0 -&gt; Color(0xffe04447)</span>
<span class="nc bnc" id="L160" title="All 4 branches missed.">        35.0 -&gt; Color(0xffd9be27)</span>
<span class="nc bnc" id="L161" title="All 4 branches missed.">        25.0 -&gt; Color(0xff1fb26c)</span>
<span class="nc bnc" id="L162" title="All 4 branches missed.">        15.0 -&gt; Color(0xFFD3D3D3)</span>
<span class="nc" id="L163">        else -&gt; Color(0xFF2E2E2E)</span>
    }

<span class="nc" id="L166">    val height = when (weight) {</span>
<span class="nc bnc" id="L167" title="All 4 branches missed.">        45.0 -&gt; 120.dp</span>
<span class="nc bnc" id="L168" title="All 4 branches missed.">        35.0 -&gt; 110.dp</span>
<span class="nc bnc" id="L169" title="All 4 branches missed.">        25.0 -&gt; 90.dp</span>
<span class="nc bnc" id="L170" title="All 4 branches missed.">        10.0 -&gt; 70.dp</span>
<span class="nc bnc" id="L171" title="All 4 branches missed.">        5.0 -&gt; 50.dp</span>
<span class="nc bnc" id="L172" title="All 4 branches missed.">        2.5 -&gt; 40.dp</span>
<span class="nc" id="L173">        else -&gt; 40.dp</span>
    }

<span class="nc" id="L176">    val contrast = ColorUtils.calculateContrast(</span>
<span class="nc" id="L177">        MaterialTheme.colorScheme.onSurface.toArgb(),</span>
<span class="nc" id="L178">        weightColor.toArgb())</span>

<span class="nc" id="L180">    Box(</span>
<span class="nc" id="L181">        modifier = Modifier</span>
<span class="nc" id="L182">            .clip(RoundedCornerShape(4.dp))</span>
<span class="nc" id="L183">            .width(22.dp)</span>
<span class="nc" id="L184">            .height(height)</span>
<span class="nc" id="L185">            .background(</span>
<span class="nc" id="L186">                brush = Brush.horizontalGradient(</span>
<span class="nc" id="L187">                    colors = listOf(</span>
<span class="nc" id="L188">                        weightColor.copy(alpha = .8f),</span>
<span class="nc" id="L189">                        weightColor,</span>
                    )
                )
            ),
    ) {
<span class="nc bnc" id="L194" title="All 4 branches missed.">        Text(</span>
<span class="nc" id="L195">            weight.toString().replace(&quot;.0&quot;, &quot;&quot;),</span>
<span class="nc bnc" id="L196" title="All 2 branches missed.">            color = if (contrast &gt; 1.5f) Color.White else Color.Black,</span>
<span class="nc" id="L197">            overflow = TextOverflow.Visible,</span>
<span class="nc" id="L198">            fontSize = 10.sp,</span>
<span class="nc" id="L199">            modifier = Modifier.align(Alignment.BottomCenter))</span>
<span class="nc" id="L200">    }</span>
<span class="nc bnc" id="L201" title="All 2 branches missed.">}</span>

@Preview
@Composable
<span class="nc bnc" id="L205" title="All 4 branches missed.">fun PlateStackPreview() {</span>
<span class="nc" id="L206">    Column(</span>
<span class="nc" id="L207">        verticalArrangement = Arrangement.spacedBy(18.dp)</span>
    ) {
<span class="nc bnc" id="L209" title="All 4 branches missed.">        PlateStack(plates = mapOf(</span>
<span class="nc" id="L210">            45.0 to 2,</span>
<span class="nc" id="L211">            35.0 to 1,</span>
<span class="nc" id="L212">            5.0 to 1</span>
<span class="nc" id="L213">        ))</span>
<span class="nc" id="L214">    }</span>
<span class="nc bnc" id="L215" title="All 2 branches missed.">}</span>
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span></div></body></html>